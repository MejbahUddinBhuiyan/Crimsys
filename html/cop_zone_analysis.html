<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Zone Analysis – CRIMSYS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/Crimsys/css/styles.css" rel="stylesheet">

  <style>
    .page-wrap{max-width:1200px;margin:0 auto}
    .glass{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);
      backdrop-filter:blur(12px) saturate(140%);-webkit-backdrop-filter:blur(12px) saturate(140%);
      border-radius:16px;box-shadow:0 18px 40px rgba(0,0,0,.35)}
    .glass-header{padding:14px 18px}
    .glass-body{padding:18px}
    .title{color:#fff;letter-spacing:.06em;text-transform:uppercase;font-weight:800}
    .mini{font-size:.9rem;color:#cbd5e1}
    .chart-card{padding:12px}

    .form-control,.form-select{
      background:rgba(255,255,255,.08)!important;
      border:1px solid rgba(255,255,255,.20)!important;
      color:#fff!important;
    }
    .form-control:focus,.form-select:focus{
      background:rgba(255,255,255,.14)!important;
      border-color:#e11d48!important;
      box-shadow:0 0 0 .2rem rgba(225,29,72,.25); color:#fff!important;
    }
    table.table-dark th,table.table-dark td{vertical-align:middle}

    /* native select → dark popup */
    :root{ color-scheme: dark; }
    select.form-select{appearance:none;-webkit-appearance:none;-moz-appearance:none;}
    select.form-select option, select.form-select optgroup{
      background:#0f0f11; color:#fff;
    }
    select.form-select::-webkit-listbox{ background:#0f0f11; color:#fff; }
    select.form-select option:checked{ background:#1b1f25; color:#fff; }
    select.form-select option:hover{ background:#232833; color:#fff; }

    /* caret cue */
    .select-cue{position:relative}
    .select-cue::after{
      content:"▾";
      position:absolute; right:12px; top:50%; transform:translateY(-50%);
      pointer-events:none; color:#d8d8d8; font-size:14px; text-shadow:0 1px 0 rgba(0,0,0,.35);
    }
  </style>
</head>

<body class="radish-black-bg">
<nav class="navbar navbar-dark topbar">
  <div class="container d-flex justify-content-between">
    <a class="btn btn-outline-accent btn-sm" href="/Crimsys/html/cop_home.html">← Back</a>
    <a class="brand-logo" href="/Crimsys/">CRIMSYS</a>
  </div>
</nav>

<main class="container py-4 page-wrap">
  <div class="glass glass-header mb-3 d-flex align-items-center justify-content-between">
    <h4 class="title mb-0">Zone Analysis</h4>
    <div class="text-white-50 mini">Read-only analytics powered by <code>fir_zone_map</code></div>
  </div>

  <!-- Filters -->
  <div class="glass glass-body mb-3">
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label class="form-label text-white-50">From</label>
        <input type="date" id="fFrom" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="form-label text-white-50">To</label>
        <input type="date" id="fTo" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="form-label text-white-50">District</label>
        <div class="select-cue">
          <select id="fDistrict" class="form-select">
            <option value="">All</option>
          </select>
        </div>
      </div>
      <div class="col-md-3">
        <label class="form-label text-white-50">Thana</label>
        <div class="select-cue">
          <select id="fThana" class="form-select" disabled>
            <option value="">All</option>
          </select>
        </div>
      </div>
      <div class="col-12 d-flex gap-2 mt-2">
        <button id="btnApply" class="btn btn-accent">Apply</button>
        <button id="btnReset" class="btn btn-outline-accent">Reset</button>
      </div>
    </div>
  </div>

  <!-- Totals table + chart -->
  <div class="glass glass-body mb-3">
    <div class="d-flex align-items-center justify-content-between">
      <h5 class="text-white mb-2">Totals by Zone</h5>
      <div class="mini">Top hotspots by FIR count</div>
    </div>
    <div class="row g-3">
      <div class="col-lg-6">
        <table class="table table-dark table-striped" id="tblTotals"></table>
      </div>
      <div class="col-lg-6 chart-card">
        <canvas id="chartTotals" height="220"></canvas>
      </div>
    </div>
  </div>

  <!-- Monthly trend -->
  <div class="glass glass-body mb-3">
    <h5 class="text-white mb-2">Monthly Trend</h5>
    <canvas id="chartMonthly" height="230"></canvas>
  </div>

  <!-- Status mix + High priority + Avg age -->
  <div class="row g-3">
    <div class="col-lg-6">
      <div class="glass glass-body">
        <h5 class="text-white mb-2">Status Mix by Zone</h5>
        <canvas id="chartStatus" height="230"></canvas>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="glass glass-body mb-3">
        <h5 class="text-white mb-2">High Priority (count)</h5>
        <canvas id="chartHigh" height="180"></canvas>
      </div>
      <div class="glass glass-body">
        <h5 class="text-white mb-2">Average Case Age (days)</h5>
        <canvas id="chartAge" height="180"></canvas>
      </div>
    </div>
  </div>

  <div class="py-4"></div>
</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="/Crimsys/js/zone_analysis.js"></script>
</body>
</html>
